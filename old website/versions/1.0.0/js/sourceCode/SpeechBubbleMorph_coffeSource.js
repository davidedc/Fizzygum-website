// Generated by CoffeeScript 1.10.0
window.SpeechBubbleMorph_coffeSource = '# SpeechBubbleMorph ///////////////////////////////////////////////////\n\n#\n#	I am a comic-style speech bubble that can display either a string,\n#	a Morph, a Canvas or a toString() representation of anything else.\n#	If I am invoked using popUp() I behave like a tool tip.\n#\n\nclass SpeechBubbleMorph extends Morph\n  # this is so we can create objects from the object class name \n  # (for the deserialization process)\n  namedClasses[@name] = @prototype\n\n  contents: null\n  padding: null # additional vertical pixels\n  isClickable: false\n  morphInvokingThis: null\n\n  constructor: (\n    @contents="",\n    @morphInvokingThis,\n    @color = (new Color 230, 230, 230),\n    cornerRadius,\n    @padding = 0,\n    isThought = false) ->\n      # console.log "bubble super"\n      super()\n      @cornerRadius = cornerRadius or 6\n      @appearance = new BubblyAppearance @, isThought, true\n      # console.log @color\n  \n  @createBubbleHelpIfHandStillOnMorph: (contents, morphInvokingThis) ->\n    # console.log "bubble createBubbleHelpIfHandStillOnMorph"\n    # let\'s check that the item that the\n    # bubble is about is still actually there\n    # and the mouse is still over it, otherwise\n    # do nothing.\n    if morphInvokingThis.root() == world and morphInvokingThis.boundsContainPoint world.hand.position()\n      theBubble = new @ localize(contents), morphInvokingThis, null, null\n      theBubble.popUp theBubble.morphInvokingThis.rightCenter().add new Point -8, 0\n\n  @createInAWhileIfHandStillContainedInMorph: (morphInvokingThis, contents, delay = 500) ->\n    # console.log "bubble createInAWhileIfHandStillContainedInMorph"\n    if AutomatorRecorderAndPlayer.animationsPacingControl and\n     AutomatorRecorderAndPlayer.state != AutomatorRecorderAndPlayer.IDLE\n        @createBubbleHelpIfHandStillOnMorph contents, morphInvokingThis\n    else\n      setTimeout (=>\n        @createBubbleHelpIfHandStillOnMorph contents, morphInvokingThis\n        )\n        , delay\n  \n  # SpeechBubbleMorph invoking:\n  popUp: (pos, isClickable) ->\n    # console.log "bubble popup"\n    @fullRawMoveTo pos.subtract new Point 0, @height()\n    @fullRawMoveWithin world\n\n    @buildAndConnectChildren()\n\n    world.add @\n    @addFullShadow()\n    @fullChanged()\n    world.hand.destroyTemporaries()\n    world.hand.temporaries.push @\n    if isClickable\n      @mouseEnter = ->\n        @destroy()\n    else\n      @isClickable = false\n    \n  buildAndConnectChildren: ->\n    # console.log "bubble buildAndConnectChildren"\n    # re-build my contents\n    if @contentsMorph\n      @contentsMorph = @contentsMorph.destroy()\n    if @contents instanceof Morph\n      @contentsMorph = @contents\n    else if isString @contents\n      @contentsMorph = new TextMorph(\n        @contents,\n        WorldMorph.preferencesAndSettings.bubbleHelpFontSize,\n        null,\n        false,\n        true,\n        "center")\n    else if @contents instanceof HTMLCanvasElement\n      @contentsMorph = new Morph()\n      @contentsMorph.silentRawSetWidth @contents.width\n      @contentsMorph.silentRawSetHeight @contents.height\n      @contentsMorph.backBuffer = @contents\n      @contentsMorph.backBufferContext = @contentsMorph.backBuffer.getContext "2d"\n    else\n      @contentsMorph = new TextMorph(\n        @contents.toString(),\n        WorldMorph.preferencesAndSettings.bubbleHelpFontSize,\n        null,\n        false,\n        true,\n        "center")\n    @add @contentsMorph\n\n    # adjust my layout\n    @silentRawSetWidth @contentsMorph.width() + ((if @padding then @padding * 2 else @cornerRadius * 2))\n    @silentRawSetHeight @contentsMorph.height() + @cornerRadius + @padding * 2 + 2\n\n    # draw my outline\n    #super()\n\n    # position my contents\n    @contentsMorph.fullRawMoveTo @position().add(\n      new Point(@padding or @cornerRadius, @padding + 1))\n\n\n';
