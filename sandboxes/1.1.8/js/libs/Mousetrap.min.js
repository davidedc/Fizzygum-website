var Mousetrap,_KEYCODE_MAP,_MAP,_REVERSE_MAP,_SHIFT_MAP,_SPECIAL_ALIASES,_addEvent,_bindMultiple,_bindSequence,_bindSingle,_callbacks,_characterFromEvent,_directMap,_eventModifiers,_fireCallback,_getMatches,_getReverseMap,_handleCharacter,_handleKey,_ignoreNextKeyup,_isModifier,_modifiersMatch,_pickBestAction,_resetSequenceTimer,_resetSequences,_resetTimer,_sequenceLevels,_sequenceType,i;for(_MAP={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},_KEYCODE_MAP={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},_SHIFT_MAP={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},_SPECIAL_ALIASES={option:"alt",command:"meta",return:"enter",escape:"esc"},_REVERSE_MAP=void 0,_callbacks={},_directMap={},_sequenceLevels={},_resetTimer=void 0,_ignoreNextKeyup=!1,_sequenceType=!1,i=1;i<20;)_MAP[111+i]="f"+i,++i;for(i=0;i<=9;)_MAP[i+96]=i,++i;_characterFromEvent=function(e){return"keypress"===e.type?String.fromCharCode(e.which):_MAP[e.which]?_MAP[e.which]:_KEYCODE_MAP[e.which]?_KEYCODE_MAP[e.which]:String.fromCharCode(e.which).toLowerCase()},_modifiersMatch=function(e,t){return e.sort().join(",")===t.sort().join(",")},_resetSequences=function(e,t){var i,n;for(n in e=e||{},i=!1,n=void 0,_sequenceLevels)e[n]&&_sequenceLevels[n]>t?i=!0:_sequenceLevels[n]=0;if(!i)return _sequenceType=!1},_getMatches=function(e,t,n,r,a){var c,_,s,o,u;if(i=void 0,_=void 0,o=[],c=n.type,!_callbacks[e])return[];for("keyup"===c&&_isModifier(e)&&(t=[e]),i=s=0,u=_callbacks[e].length;0<=u?s<u:s>u;i=0<=u?++s:--s)(_=_callbacks[e][i]).seq&&_sequenceLevels[_.seq]!==_.level||c===_.action&&("keypress"===c&&!n.metaKey&&!n.ctrlKey||_modifiersMatch(t,_.modifiers))&&(r&&_.combo===a&&_callbacks[e].splice(i,1),o.push(_));return o},_eventModifiers=function(e){var t;return t=[],e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t},_fireCallback=function(e,t,i){if(!Mousetrap.stopCallback(t,t.target||t.srcElement,i))return!1===e(t,i)?(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.returnValue=!1,t.cancelBubble=!0):void 0},_handleCharacter=function(e,t){var n,r,a,c;for(n=_getMatches(e,_eventModifiers(t),t),i=void 0,r={},a=0,c=!1,i=0;i<n.length;)n[i].seq?(c=!0,a=Math.max(a,n[i].level),r[n[i].seq]=1,_fireCallback(n[i].callback,t,n[i].combo)):(c||_sequenceType||_fireCallback(n[i].callback,t,n[i].combo),++i);if(t.type===_sequenceType&&!_isModifier(e))return _resetSequences(r,a)},_handleKey=function(e){var t;if("number"!=typeof e.which&&(e.which=e.keyCode),t=_characterFromEvent(e)){if("keyup"!==e.type||_ignoreNextKeyup!==t)return _handleCharacter(t,e);_ignoreNextKeyup=!1}},_isModifier=function(e){return"shift"===e||"ctrl"===e||"alt"===e||"meta"===e},_resetSequenceTimer=function(){return clearTimeout(_resetTimer),_resetTimer=setTimeout(_resetSequences,1e3)},_getReverseMap=function(){var e;if(!_REVERSE_MAP)for(e in _REVERSE_MAP={},_MAP)e>95&&e<112||_MAP.hasOwnProperty(e)&&(_REVERSE_MAP[_MAP[e]]=e);return _REVERSE_MAP},_pickBestAction=function(e,t,i){return i||(i=_getReverseMap()[e]?"keydown":"keypress"),"keypress"===i&&t.length&&(i="keydown"),i},_bindSequence=function(e,t,n,r){var a,c,_;for(_sequenceLevels[e]=0,r||(r=_pickBestAction(t[0],[])),c=function(){return _sequenceType=r,++_sequenceLevels[e],_resetSequenceTimer()},a=function(t){return _fireCallback(n,t,e),"keyup"!==r&&(_ignoreNextKeyup=_characterFromEvent(t)),setTimeout(_resetSequences,10)},i=void 0,i=0,_=[];i<t.length;)_bindSingle(t[i],i<t.length-1?c:a,r,e,i),_.push(++i);return _},_bindSingle=function(e,t,n,r,a){var c,_,s,o;if(_directMap[e+":"+n]=t,o=(e=e.replace(/\s+/g," ")).split(" "),i=void 0,c=void 0,void 0,s=[],!(o.length>1)){for(_="+"===e?["+"]:e.split("+"),i=0;i<_.length;)c=_[i],_SPECIAL_ALIASES[c]&&(c=_SPECIAL_ALIASES[c]),n&&"keypress"!==n&&_SHIFT_MAP[c]&&(c=_SHIFT_MAP[c],s.push("shift")),_isModifier(c)&&s.push(c),++i;return n=_pickBestAction(c,s,n),_callbacks[c]||(_callbacks[c]=[]),_getMatches(c,s,{type:n},!r,e),_callbacks[c][r?"unshift":"push"]({callback:t,modifiers:s,action:n,seq:r,level:a,combo:e})}_bindSequence(e,o,t,n)},_bindMultiple=function(e,t,n){var r;for(i=0,r=[];i<e.length;)_bindSingle(e[i],t,n),r.push(++i);return r},(_addEvent=function(e,t,i){if(!e.addEventListener)return e.attachEvent("on"+t,i);e.addEventListener(t,i,!1)})(document,"keypress",_handleKey),_addEvent(document,"keydown",_handleKey),_addEvent(document,"keyup",_handleKey),Mousetrap={bind:function(e,t,i){return _bindMultiple(e=e instanceof Array?e:[e],t,i),this},unbind:function(e,t){return Mousetrap.bind(e,(function(){}),t)},trigger:function(e,t){return _directMap[e+":"+t]&&_directMap[e+":"+t]({},e),this},reset:function(){return _callbacks={},_directMap={},this},stopCallback:function(e,t){return!(" "+t.className+" ").contains(" mousetrap ")&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.contentEditable&&"true"===t.contentEditable)}},window.Mousetrap=Mousetrap;