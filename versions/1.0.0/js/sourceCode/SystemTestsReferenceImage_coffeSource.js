// Generated by CoffeeScript 1.10.0
window.SystemTestsReferenceImage_coffeSource = '# Holds image data and metadata.\n# These images are saved as javascript files\n# and are used to test the actual rendering\n# on screen (or parts of it)\n\n# REQUIRES HashCalculator\n\nclass SystemTestsReferenceImage\n  imageName: \'\'\n  # the image data as string, like\n  # e.g. "data:image/png;base64,iVBORw0KGgoAA..."\n  imageData: \'\'\n  systemInfo: null\n  hashOfData: 0\n  hashOfSystemInfo: 0\n  fileName = \'\'\n\n  constructor: (@imageName, @imageData, @systemInfo) ->\n    @hashOfData = HashCalculator.calculateHash(@imageData)\n    @hashOfSystemInfo = HashCalculator.calculateHash(JSON.stringify(@systemInfo))\n\n    # The filenames contain the test name and the image "number"\n    # AND hashes of data and metadata. This is because the same\n    # test/step might have different images for different\n    # OSs/browsers, so they all must be different files.\n    # The js files contain directly the code to load the image.\n    # There can be multiple files for the same image, since\n    # the images vary according to OS and Browser, so for\n    # each image of each test there is an array of files.\n    # No extension added, cause we are going to\n    # generate both png and js files.\n    @fileName = @imageName + "-systemInfoHash" + @hashOfSystemInfo + "-dataHash" + @hashOfData\n\n  createJSContent: ->\n  	  return "if (!AutomatorRecorderAndPlayer.loadedImages.hasOwnProperty(\'" + @imageName + "\')) { " + "AutomatorRecorderAndPlayer.loadedImages." + @imageName + \' = []; } \' + "AutomatorRecorderAndPlayer.loadedImages." + @imageName + \'.push(\' + JSON.stringify(@) + \');\'\n\n  addToZipAsJS: (zip) ->\n  	zip.file(\n  	  @fileName + ".js",\n  	  @createJSContent()\n  	)\n\n  # This method does the same of the one above\n  # but it eliminates the "obtained-" text everywhere\n  # in the content. In this way, the file can just\n  # be renamed and can be added to the tests together\n  # with all the other "good screenshots"\n  # right away withouth having to open it and doing\n  # the change manually.\n  addToZipAsJSIgnoringItsAnObtained: (zip) ->\n  	zip.file(\n  	  @fileName + ".js",\n  	  @createJSContent().replace(/obtained-/g,"")\n  	)\n\n  addToZipAsPNG: (zip) ->\n    # the imageData string contains a little bit of string\n    # that we need to strip out before the base64-encoded png data\n    zip.file(\n      @fileName + ".png",\n      @imageData.replace(/^data:image\\/png;base64,/, ""), {base64: true}\n    )\n';
